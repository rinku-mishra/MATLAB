clc;clear;

ks1 = 0.0001;
ks2 = 0.1;

[x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,y1,y2,y3,y4,y5,y6,y7,y8,y9,y10] = surface_1TiA_gamma(ks1,ks2);
ks = linspace(ks1,ks2,100);

r1 = zeros (100,9);
for i = 1:length(ks)
    p2 = [x1(i,1),x2(i,1),x3(i,1),x4(i,1),x5(i,1),x6(i,1),x7(i,1),x8(i,1),x9(i,1),x10(i,1)];
    r1(i,:)= roots(p2);
%     t(i,:) =  r1(i,:)* r1(i,:);
end
figure(1)
plot(ks(1:100),r1(1:100,7),'linewidth',2);
grid on
xlabel('\kappa');
ylabel('\omega_r');

% figure(2)
% plot(ks(1:100),r1(1:100,8),'linewidth',2);
% xlabel('\kappa');
% ylabel('\omega_r');
% grid on
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for k = 1:length(ks)
 a(k) = -y1(k,1);
 b(k) =  x1(k,1);
 c(k) = (45*r1(k,8)^2*y1(k,1))+y2(k,1);
 d(k) = -(36*r1(k,8)^2*x1(k,1))-(8*r1(k,8)*x2(k,1))-x3(k,1);
 e(k) = (210*y1(k,1)*r1(k,8)^4)-(28*r1(k,8)^2*y2(k,1))-(7*r1(k,8)*y3(k,1))-y4(k,1);
 f(k) = (126*r1(k,8)^4*x1(k,1))+(56*r1(k,8)^3*x2(k,1))+(21*r1(k,8)^2*x3(k,1))+(6*x4(k,1)*r1(k,8))+ x5(k,1);
 g(k) = (210*y1(k,1)*r1(k,8)^6)+(70*y2(k,1)*r1(k,8)^4)+(35*y3(k,1)*r1(k,8)^3)+(15*y4(k,1)*r1(k,8)^2)+(5*y5(k,1)*r1(k,8))+(y6(k,1));
 h(k) = -(84*x1(k,1)*r1(k,8)^6)-(56*x2(k,1)*r1(k,8)^5)-(35*x3(k,1)*r1(k,8)^4)-(20*x4(k,1)*r1(k,8)^3)-(10*x5(k,1)*r1(k,8)^2)-(4*r1(k,8)*x6(k,1))-x7(k,1);
 p1(k) = -(45*r1(k,8)^8*y1(k,1))-(28*r1(k,8)^6*y2(k,1))-(21*r1(k,8)^5*y3(k,1))-(15*r1(k,8)^4*y4(k,1))-(10*r1(k,8)^3*y5(k,1))...
         -(6*r1(k,8)^2*y6(k,1))-(3*r1(k,8)*y7(k,1))-y8(k,1);
 q1(k) = (9*r1(k,8)^8*x1(k,1))+(8*r1(k,8)^7*x2(k,1))+(7*r1(k,8)^6*x3(k,1))+(6*r1(k,8)^5*x4(k,1))+(5*r1(k,8)^4*x5(k,1))...
         +(4*r1(k,8)^3*x6(k,1))+(3*r1(k,8)^2*x7(k,1))+(2*x8(k,1)*r1(k,8))+x9(k,1);   
 s(k) = (y1(k,1)*r1(k,8)^10)+(y2(k,1)*r1(k,8)^8)+(y3(k,1)*r1(k,8)^7)+(y4(k,1)*r1(k,8)^6)+(y5(k,1)*r1(k,8)^5)...
         +(y6(k,1)*r1(k,8)^4)+(y7(k,1)*r1(k,8)^3)+(y8(k,1)*r1(k,8)^2)+(r1(k,8)*y9(k,1))+(y10(k,1));
 
 
end
% 
z1 = a';z2 = b';z3 = c';z4 = d'; z5 = e';z6 = f';z7 = g'; z8 = h';z9 = p1';z10 = q1';z11 = s';
r2 = zeros (100,10);
for i = 1:length(ks)
    p1 = [z1(i,1),z2(i,1),z3(i,1),z4(i,1),z5(i,1),z6(i,1),z7(i,1),z8(i,1),z9(i,1),z10(i,1),z11(i,1)];
    r2(i,:)= roots(p1);
end
% figure(3)
% plot(ks(1:100),r2(1:100,10),'linewidth',2);
% xlabel('\kappa');
% ylabel('\omega_i');
% grid on
